---
title: "Potential Hydrochemographs"
author: "LAR"
date: "4/22/2022"
output: html_document
---

```{r setup, echo = FALSE, warning= FALSE, message = FALSE, include=FALSE}
source("C:/Users/linne/Downloads/PhD_Code/EcosysGCBClass2022/Hydro_Chemo_Graphs/Code/Functions/chemo_hydrograph.R")

library(tidyverse)
### potential hydrochemographs from Green Lake 4 ###
source("C:/Users/linne/Downloads/PhD_Code/EcosysGCBClass2022/Hydro_Chemo_Graphs/Data/Call_Data.R") 
Gl4stoich <- Gl4Chem |>
 # mutate(tntp = as.numeric(TN)/as.numeric(TP)) |>
  mutate(tdn.tdp = as.numeric(TDN)/as.numeric(TDP),
         don.dop = as.numeric(DON)/as.numeric(DOP))

p1 <- chemo_hydrograph(Gl4stoich, Gl4stoich$don.dop, "DON:DOP (molar ratio)", Gl4Dis)
p2 <- chemo_hydrograph(Gl4stoich, Gl4stoich$tdn.tdp, "TDN:TDP (molar ratio)", Gl4Dis)
p3 <- chemo_hydrograph(Gl4Chem, Gl4Chem$NH4., "Ammonium"~(mu~eq~L^-1), Gl4Dis)
p4 <- chemo_hydrograph(Gl4Chem, Gl4Chem$NO3., "Nitrate"~(mu~eq~L^-1), Gl4Dis)
p5 <- chemo_hydrograph(Gl4Chem, Gl4Chem$TDN, "Total Dissolved N"~(mu~mol~L^-1), Gl4Dis)
p6 <- chemo_hydrograph(Gl4Chem, Gl4Chem$DON, "Dissolved Organic N"~(mu~mol~L^-1), Gl4Dis)
p7 <- chemo_hydrograph(Gl4Chem, Gl4Chem$IN, "Inorganic N"~(mu~eq~L^-1), Gl4Dis)
p8 <- chemo_hydrograph(Gl4Chem, Gl4Chem$TDP, "Total Dissolved P"~(mu~mol~L^-1), Gl4Dis)
p9 <- chemo_hydrograph(Gl4Chem, Gl4Chem$DOP, "Dissolved Organic P"~(mu~mol~L^-1), Gl4Dis)

### potential hydrochemogrpahs from Loch Vale outlet ###
lochvale <- read.csv("C:/Users/linne/Downloads/PhD_Code/EcosysGCBClass2022/Hydro_Chemo_Graphs/Data/USGS_lochvaleoutlet.csv") |>
  select(-X, -X.1) |>
  mutate(date = as.Date(Date))

p10 <- chemo_hydrograph(lochvale, lochvale$no3.po4, "NO3:PO4 (molar ratio)", lochvale)
p11 <- chemo_hydrograph(lochvale, lochvale$Nitrate_mgl, "Nitrate"~(mg~L~L^-1), lochvale)
p12 <- chemo_hydrograph(lochvale, lochvale$Phosphate_mgl, "Phosphate"~(mg~L~L^-1), lochvale)

```

## Niwot Ridge LTER 
These data are from the stream outlet of Green Lake 4. The winter chemistry data is collected beneath the ice in the lake. During 2014, the discharge data deviates from the other streams and the typical seasonal pattern. The lead technician for Niwot Ridge LTER reported nothing obvious on the ground that would casue an error. So it is possible that the discharge data from 2014 are either real or there could have been some sort of sensor issue. 

### Hydrochemographs!!!
Stoichiometric timeseries if we decide we want to use any of these
```{r, echo=FALSE, warning=FALSE, message=FALSE}
p1
p2
```

We have good data to create hydrochemographs for ammonium, nitrate, TDN, DON, IN, TDP, and DOP. Here is the nitrate hydrochemograph. Note the units are the worst possible units anyone could provide with data. 
```{r, echo=FALSE, warning=FALSE, message=FALSE}
p4
```

## Loch Vale 
These data are from the stream outlet of Loch Vale and were downloaded from USGS using the dataReterieval package in R (De Cicco et al., 2021). 

### More beautiful hydrochemographs!!!
```{r, echo=FALSE, warning=FALSE, message=FALSE}
p10
```

We have good nitrate and phosphate data to create hydrochemographs from this site. Here is the nitrate hydrochemograph. Note the units are mg/L.
```{r, echo=FALSE, warning=FALSE, message=FALSE}
p11
```


## Data Sources
Caine, N., J. Morse, and Niwot Ridge LTER. 2022. Streamflow for Green Lake 4, 1981 - ongoing. ver 15. Environmental Data Initiative. https://doi.org/10.6073/pasta/ff6f7947279eeeeca851baed6cd6f41a (Accessed 2022-04-22).

Caine, T. 2021. Stream water chemistry data for Green Lake 4, 1982 - ongoing. ver 12. Environmental Data Initiative. https://doi.org/10.6073/pasta/277121f0334757746d9d52ce2c2e82ab (Accessed 2022-04-22).

De Cicco, L.A., Hirsch, R.M., Lorenz, D., Watkins, W.D., 2021, dataRetrieval: R packages for discovering
and retrieving water data available from Federal hydrologic web services, doi:10.5066/P9X4L3GE

"Logistical support and/or data were provided by the USGS supported Loch Vale Watershed Long-term Ecological Research and Monitoring program and Colorado State University."